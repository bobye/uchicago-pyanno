

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Model definitions &mdash; pyanno 2.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="pyanno 2.0 documentation" href="index.html" />
    <link rel="next" title="Developer guide" href="developer_guide.html" />
    <link rel="prev" title="Finding help" href="help.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="developer_guide.html" title="Developer guide"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="help.html" title="Finding help"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">pyanno 2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="model-definitions">
<h1>Model definitions<a class="headerlink" href="#model-definitions" title="Permalink to this headline">¶</a></h1>
<p>At present, pyAnno implements three probabilistic models of data annotation:</p>
<blockquote>
<div><p>1. <a class="reference internal" href="#model-a">Model A</a> , a three-step generative model from the paper
<a class="reference internal" href="#rzhetsky2009">[Rzhetsky2009]</a>.</p>
<p>2. <a class="reference internal" href="#model-b-with-theta">Model B-with-theta</a> , a multinomial generative model from the paper
<a class="reference internal" href="#rzhetsky2009">[Rzhetsky2009]</a>.</p>
<p>3. <a class="reference internal" href="#model-b">Model B</a>, a Bayesian generalization of the model proposed in
<a class="reference internal" href="#dawid1979">[Dawid1979]</a>.</p>
</div></blockquote>
<div class="section" id="glossary">
<h2>Glossary<a class="headerlink" href="#glossary" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>annotations</dt>
<dd>The values emitted by the annotator on the available data items.
In the documentation,
<img class="math" src="_images/math/391d16aa9be108ec679aeaf14a6f3b532f4fef19.png" alt="x_i^j"/>, indicates the i-th annotation for annotator j.</dd>
<dt>labels</dt>
<dd>The possible annotations. They may be numbers, or strings, or any
discrete set of objects.</dd>
<dt>label class, or just class</dt>
<dd>Every set of labels is ordered and numbered from 0 to K. The number
associated with each label is the label class. The ground truth label class
for each data item, i, is indicated in the documentation as <img class="math" src="_images/math/6e6ceb79ebc4bf613298e0144eae25dd73de9be3.png" alt="y_i"/>.</dd>
<dt>prevalence</dt>
<dd>The prior probability of label classes</dd>
<dt>accuracy</dt>
<dd>The probability of an annotator reporting the correct label class</dd>
</dl>
</div>
<div class="section" id="model-a">
<h2>Model A<a class="headerlink" href="#model-a" title="Permalink to this headline">¶</a></h2>
<p>Model A  defines a probability distribution over data annotations with
a loop design in which each item is annotated by three users.
The distributions over annotations is defined by a
three-steps generative model:</p>
<blockquote>
<div><ol class="arabic simple">
<li>First, the model independently generates correctness values for the
triplet of annotators (e.g., CCI where C=correct, I=incorrect)</li>
<li>Second, the model generates an agreement pattern compatible with
the correctness values (e.g., CII is compatible with the agreement
patterns &#8216;abb&#8217; and &#8216;abc&#8217;, where different letters correspond to
different annotations</li>
<li>Finally, the model generates actual observations compatible with
the agreement patterns</li>
</ol>
</div></blockquote>
<p>More in detail, the model is described as follows:</p>
<ul>
<li><p class="first">Parameters <img class="math" src="_images/math/f00785bb5b1fbba0514652b693cdfd0c72c7801d.png" alt="\theta_j"/> control the prior probability that annotator
<img class="math" src="_images/math/8122aa89ea6e80784c6513d22787ad86e36ad0cc.png" alt="j"/> is correct. Thus, for each triplet of annotations
for annotators <img class="math" src="_images/math/f5047d1e0cbb50ec208923a22cd517c55100fa7b.png" alt="m"/>, <img class="math" src="_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/>, and <img class="math" src="_images/math/9b25f8e64b484493fda944d25cad453423041fe6.png" alt="l"/>, we have</p>
<p><img class="math" src="_images/math/bbffa5175db25ffd436161594d2ec2e7bb39c9d1.png" alt="P( \mathrm{X}_m \mathrm{X}_n \mathrm{X}_l | \theta ) = P( \mathrm{X}_m | \theta ) P( \mathrm{X}_n | \theta ) P( \mathrm{X}_l | \theta )"/></p>
<p>where</p>
<p><img class="math" src="_images/math/cb6a6abef6ace6d3136a2bba349feca71dc27f7d.png" alt="P( \mathrm{X}_j ) =\left\{\begin{array}{l l} \theta_j &amp; \quad \text{if } \mathrm{X}_j = \mathrm{C} \\ 1-\theta_j &amp; \quad \text{if } \mathrm{X}_j = \mathrm{I}\\ \end{array} \right."/></p>
</li>
<li><p class="first">Parameters <img class="math" src="_images/math/ff9c62c564e81a783cedf3176ff0d8859b540d08.png" alt="\omega_k"/> control the probability of observing an
annotation of class <img class="math" src="_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> over all items and annotators. From these
one can derive the parameters <img class="math" src="_images/math/10f32377ac67d94f764f12a15ea987e88c85d3e1.png" alt="\alpha"/>, which correspond
to the probability
of each agreement pattern according to the tables published in
<a class="reference internal" href="#rzhetsky2009">[Rzhetsky2009]</a>.</p>
</li>
</ul>
<p>See <a class="reference internal" href="#rzhetsky2009">[Rzhetsky2009]</a> for a more complete presentation of the model.</p>
</div>
<div class="section" id="model-b-with-theta">
<h2>Model B-with-theta<a class="headerlink" href="#model-b-with-theta" title="Permalink to this headline">¶</a></h2>
<p>Model B-with-theta is a multinomial generative model of the annotation
process. The process begins with the generation of &#8220;true&#8221; label classes,
drawn from a fixed categorical distribution. Each annotator reports
a label class with some additional noise.</p>
<p>There are two sets of parameters: <img class="math" src="_images/math/f5b4fe56b817c346d5bfd0733800694b1ceb5a53.png" alt="\gamma_k"/> controls the
prior probability of generating a label of class <img class="math" src="_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/>.
The accuracy parameter <img class="math" src="_images/math/b86e1116a21a0c7499e03e40e559b45273e230ac.png" alt="\\theta^j_k"/> controls the probability of annotator
<img class="math" src="_images/math/8122aa89ea6e80784c6513d22787ad86e36ad0cc.png" alt="j"/> reporting class <img class="math" src="_images/math/5c20717468053f101f9a58dda7990817e9469ad9.png" alt="k'"/> given that the true label is <img class="math" src="_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/>.
An important part of the model is that the error probability is controlled
by just one parameter per annotator, making estimation more robust and
efficient.</p>
<p>Formally, for annotations <img class="math" src="_images/math/391d16aa9be108ec679aeaf14a6f3b532f4fef19.png" alt="x_i^j"/> and true label classes <img class="math" src="_images/math/6e6ceb79ebc4bf613298e0144eae25dd73de9be3.png" alt="y_i"/>:</p>
<ul>
<li><p class="first">The probability of the true label classes is</p>
<p><img class="math" src="_images/math/0b348acfad592e6496c70b92bcf02dc09b11bf0e.png" alt="P(\mathbf{y} | \gamma) = \prod_i P(y_i | \gamma)"/>,</p>
<p><img class="math" src="_images/math/6a1b014c8eb786656dc139d497554b55a2c03796.png" alt="P(y_i | \gamma) = \mathrm{Categorical}(y_i; \gamma) = \gamma_{y_i}"/>.</p>
</li>
<li><p class="first">The prior over the accuracy parameters is</p>
<p><img class="math" src="_images/math/bc6ba483d28d64e4ec16aaaa7e73403ac6767270.png" alt="P(\theta_j) = \mathrm{Beta}(\theta_j; 1, 2)"/>.</p>
</li>
<li><p class="first">And finally the distribution over the annotations is</p>
<p><img class="math" src="_images/math/63618082d8f4baa94125af9f6d2ba08b6357ee90.png" alt="P(\mathbf{x} | \mathbf{y}, \theta) = \prod_i \prod_j P(x^j_i | y_i, \theta_j)"/>,</p>
<p><img class="math" src="_images/math/32e4a5a493120a843f1aaa4311a5f28870d06b7e.png" alt="P(x^j_i | y_i, \theta_j) = \left\{\begin{array}{l l} \theta_j &amp; \quad \text{if } x_i^j = y_i\\ \frac{1-\theta_j}{\sum_n \theta_n} &amp; \quad \text{otherwise}\\ \end{array} \right."/>.</p>
</li>
</ul>
<p>See <a class="reference internal" href="#rzhetsky2009">[Rzhetsky2009]</a> for more details.</p>
</div>
<div class="section" id="model-b">
<h2>Model B<a class="headerlink" href="#model-b" title="Permalink to this headline">¶</a></h2>
<p>Model B is a more general form of B-with-theta, and is also a Bayesian
generalization of the earlier model proposed in <a class="reference internal" href="#dawid1979">[Dawid1979]</a>. The generative
process is identical to the one in model B-with-theta, except that
a) the accuracy parameters are represented by a full tensor
<img class="math" src="_images/math/8648f47a3677a4cc40a73cd200677e553d32c491.png" alt="\\theta_{j,k,k'} = P(x^j = k' | y = k)"/>, and b) it defines prior
probabilities over the model parameters, <img class="math" src="_images/math/496e264a6cc9eb133fa53fbf8cfb586155bd1d42.png" alt="\\theta"/>, and <img class="math" src="_images/math/f2ca003a7da0de4994b4733e203b74ff52d42553.png" alt="\pi"/>.</p>
<p>The complete model description is as follows:</p>
<ul>
<li><p class="first">The probability of the true label classes is</p>
<p><img class="math" src="_images/math/7979783a3f454ef69db27930eb70a648b7e3a6c9.png" alt="P(\pi | \beta) = \mathrm{Dirichlet} (\pi ; \beta)"/></p>
<p><img class="math" src="_images/math/18dbf6cfe4ec013ed8acdd04b070e616cdf25fe4.png" alt="P(\mathbf{y} | \pi) = \prod_i P(y_i | \pi)"/>,</p>
<p><img class="math" src="_images/math/ebf7fb1079c7819f05769c0a2bc98f3e172ee925.png" alt="P(y_i | \pi) = \mathrm{Categorical}(y_i; \pi) = \pi_{y_i}"/></p>
</li>
<li><p class="first">The distribution over accuracy parameters is</p>
<p><img class="math" src="_images/math/4a7cadce98ec49b083ca51df680c103808c77278.png" alt="P(\theta_{j,k,:} | \alpha_k) = \mathrm{Dirichlet} ( \theta_{j,k,:} ; \alpha_k)"/></p>
<p>The hyper-parameters <img class="math" src="_images/math/63b67135e8833d91f039ecd50338c25a564d0a5a.png" alt="\alpha_k"/> define what kind of error distributions
are more likely for an annotator. For example, they can be defined such that
<img class="math" src="_images/math/6fe14cc026be555250f250f3d945529f511cf27c.png" alt="\alpha_{k,k'}"/> peaks at <img class="math" src="_images/math/81de74ae6ae28d1c2c0ede72bddac32ed7f38156.png" alt="k = k'"/> and decays for <img class="math" src="_images/math/5c20717468053f101f9a58dda7990817e9469ad9.png" alt="k'"/>
becoming increasingly dissimilar to <img class="math" src="_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/>. Such a prior is adequate
for ordinal data, where the label classes have a meaningful order.</p>
</li>
<li><p class="first">The distribution over annotation is defined as</p>
<p><img class="math" src="_images/math/ed704de688240e6f34131160937ab990e1bee511.png" alt="P(\mathbf{x} | \mathbf{y}, \theta) = \prod_i \prod_j P(x^j_i | y_i, \theta_{j,:,:})"/>,</p>
<p><img class="math" src="_images/math/38cbfb96fb753e6011d53ff067080319004f00fb.png" alt="P(x^j_i = k' | y_i = k, \theta_{j,:,:}) = \theta{j,k,k'}"/>.</p>
</li>
</ul>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils citation" frame="void" id="rzhetsky2009" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Rzhetsky2009]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>, <a class="fn-backref" href="#id4">3</a>, <a class="fn-backref" href="#id5">4</a>, <a class="fn-backref" href="#id6">5</a>)</em> Rzhetsky A., Shatkay, H., and Wilbur,
W.J. (2009). &#8220;How to get the most from
your curation effort&#8221;, PLoS Computational Biology, 5(5).</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="dawid1979" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Dawid1979]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id7">2</a>)</em> Dawid, A. P. and A. M. Skene. 1979.  Maximum likelihood
estimation of observer error-rates using the EM algorithm.  Applied
Statistics, 28(1):20&#8211;28.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Model definitions</a><ul>
<li><a class="reference internal" href="#glossary">Glossary</a></li>
<li><a class="reference internal" href="#model-a">Model A</a></li>
<li><a class="reference internal" href="#model-b-with-theta">Model B-with-theta</a></li>
<li><a class="reference internal" href="#model-b">Model B</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="help.html"
                        title="previous chapter">Finding help</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="developer_guide.html"
                        title="next chapter">Developer guide</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/models.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="developer_guide.html" title="Developer guide"
             >next</a> |</li>
        <li class="right" >
          <a href="help.html" title="Finding help"
             >previous</a> |</li>
        <li><a href="index.html">pyanno 2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Pietro Berkes, Bob Carpenter, Andrey Rzhetsky, James A. Evans.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>