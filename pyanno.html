

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pyanno Package &mdash; pyanno 2.0dev documentation</title>
    
    <link rel="stylesheet" href="static/default.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '2.0dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <link rel="top" title="pyanno 2.0dev documentation" href="index.html" />
    <link rel="up" title="Project Modules" href="modules.html" />
    <link rel="next" title="measures Package" href="pyanno.measures.html" />
    <link rel="prev" title="Project Modules" href="modules.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pyanno.measures.html" title="measures Package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="modules.html" title="Project Modules"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">pyanno 2.0dev documentation</a> &raquo;</li>
          <li><a href="modules.html" accesskey="U">Project Modules</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="pyanno-package">
<h1>pyanno Package<a class="headerlink" href="#pyanno-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2><a class="reference internal" href="#module-pyanno" title="pyanno"><tt class="xref py py-mod docutils literal"><span class="pre">pyanno</span></tt></a> Package<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-pyanno"></span></div>
<div class="section" id="abstract-model-module">
<h2><tt class="xref py py-mod docutils literal"><span class="pre">abstract_model</span></tt> Module<a class="headerlink" href="#abstract-model-module" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-pyanno.abstract_model"></span><p>Defines an abstract class that specifies the interface of pyAnno models.</p>
<dl class="class">
<dt id="pyanno.abstract_model.AbstractModel">
<em class="property">class </em><tt class="descclassname">pyanno.abstract_model.</tt><tt class="descname">AbstractModel</tt><a class="reference internal" href="modules/pyanno/abstract_model.html#AbstractModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.abstract_model.AbstractModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">traits.has_traits.HasTraits</span></tt></p>
<p>Abstract class defining the interface of a pyAnno model.</p>
<dl class="method">
<dt id="pyanno.abstract_model.AbstractModel.are_annotations_compatible">
<tt class="descname">are_annotations_compatible</tt><big>(</big><em>annotations</em><big>)</big><a class="reference internal" href="modules/pyanno/abstract_model.html#AbstractModel.are_annotations_compatible"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.abstract_model.AbstractModel.are_annotations_compatible" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the annotations are compatible with the model.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="pyanno.abstract_model.AbstractModel.create_initial_state">
<em class="property">static </em><tt class="descname">create_initial_state</tt><big>(</big><em>nclasses</em><big>)</big><a class="reference internal" href="modules/pyanno/abstract_model.html#AbstractModel.create_initial_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.abstract_model.AbstractModel.create_initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory method returning a model with random initial parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nclasses</strong> (<em>int</em>) &#8211; Number of label classes</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.abstract_model.AbstractModel.generate_annotations">
<tt class="descname">generate_annotations</tt><big>(</big><em>nitems</em><big>)</big><a class="reference internal" href="modules/pyanno/abstract_model.html#AbstractModel.generate_annotations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.abstract_model.AbstractModel.generate_annotations" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random annotation set from the model.</p>
<p>Sample a random set of annotations from the probability distribution
defined the current model parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nitems</strong> (<em>int</em>) &#8211; Number of items to sample</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>annotations</strong> (ndarray, shape = (n_items, n_annotators)) - annotations[i,j] is the annotation of annotator j for item i</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.abstract_model.AbstractModel.log_likelihood">
<tt class="descname">log_likelihood</tt><big>(</big><em>annotations</em><big>)</big><a class="reference internal" href="modules/pyanno/abstract_model.html#AbstractModel.log_likelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.abstract_model.AbstractModel.log_likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log likelihood of a set of annotations given the model.</p>
<p>Returns log P(annotations | current model parameters).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>annotations</strong> (<em>ndarray, shape = (n_items, n_annotators)</em>) &#8211; annotations[i,j] is the annotation of annotator j for item i</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>log_lhood</strong> (float) - log likelihood of <cite>annotations</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.abstract_model.AbstractModel.map">
<tt class="descname">map</tt><big>(</big><em>annotations</em><big>)</big><a class="reference internal" href="modules/pyanno/abstract_model.html#AbstractModel.map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.abstract_model.AbstractModel.map" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum a posteriori (MAP) estimate of parameters.</p>
<p>Estimate the model parameters from a set of observed annotations
using maximum a posteriori estimation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>annotations</strong> (<em>ndarray, shape = (n_items, n_annotators)</em>) &#8211; annotations[i,j] is the annotation of annotator j for item i</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.abstract_model.AbstractModel.mle">
<tt class="descname">mle</tt><big>(</big><em>annotations</em><big>)</big><a class="reference internal" href="modules/pyanno/abstract_model.html#AbstractModel.mle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.abstract_model.AbstractModel.mle" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum likelihood estimate (MLE) of parameters.</p>
<p>Estimate the model parameters from a set of observed annotations
using maximum likelihood estimation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>annotations</strong> (<em>ndarray, shape = (n_items, n_annotators)</em>) &#8211; annotations[i,j] is the annotation of annotator j for item i</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.abstract_model.AbstractModel.sample_posterior_over_accuracy">
<tt class="descname">sample_posterior_over_accuracy</tt><big>(</big><em>annotations</em>, <em>nsamples</em>, <em>burn_in_samples=0</em>, <em>thin_samples=1</em><big>)</big><a class="reference internal" href="modules/pyanno/abstract_model.html#AbstractModel.sample_posterior_over_accuracy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.abstract_model.AbstractModel.sample_posterior_over_accuracy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return samples from posterior over the accuracy parameters.</p>
<p>Draw samples from P(accuracy parameters | data, model parameters).
The accuracy parameters control the probability of an annotator
reporting the correct label (the exact nature of these parameters
varies from model to model).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>annotations</strong> (<em>ndarray, shape = (n_items, n_annotators)</em>) &#8211; annotations[i,j] is the annotation of annotator j for item i</li>
<li><strong>nsamples</strong> (<em>int</em>) &#8211; Number of samples to return (i.e., burn-in and thinning samples
are not included)</li>
<li><strong>burn_in_samples</strong> (<em>int</em>) &#8211; Discard the first <cite>burn_in_samples</cite> during the initial burn-in
phase, where the Monte Carlo chain converges to the posterior</li>
<li><strong>thin_samples</strong> (<em>int</em>) &#8211; Only return one every <cite>thin_samples</cite> samples in order to reduce
the auto-correlation in the sampling chain. This is called
&#8220;thinning&#8221; in MCMC parlance.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>samples</strong> (ndarray, shape = (n_samples, ??)) - Array of samples from the posterior distribution over parameters.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyanno.modelA">
<span id="modela-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">modelA</span></tt> Module<a class="headerlink" href="#module-pyanno.modelA" title="Permalink to this headline">¶</a></h2>
<p>This module defines the class ModelA, an implementation of model A from
Rzhetsky et al., 2009.</p>
<div class="section" id="reference">
<h3>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h3>
<p>Rzhetsky A., Shatkay, H., and Wilbur, W.J. (2009). &#8220;How to get the most from
your curation effort&#8221;, PLoS Computational Biology, 5(5).</p>
<dl class="class">
<dt id="pyanno.modelA.ModelA">
<em class="property">class </em><tt class="descclassname">pyanno.modelA.</tt><tt class="descname">ModelA</tt><big>(</big><em>nclasses</em>, <em>theta</em>, <em>omega</em>, <em>**traits</em><big>)</big><a class="reference internal" href="modules/pyanno/modelA.html#ModelA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelA.ModelA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyanno.abstract_model.AbstractModel" title="pyanno.abstract_model.AbstractModel"><tt class="xref py py-class docutils literal"><span class="pre">pyanno.abstract_model.AbstractModel</span></tt></a></p>
<p>Implementation of Model A from (Rzhetsky et al., 2009).</p>
<p>The model defines a probability distribution over data annotations
in which each item is annotated by three users. The distributions is
described according to a three-steps generative model:</p>
<blockquote>
<div><p>1. First, the model independently generates correctness values for the
triplet of annotators (e.g., CCI where C=correct, I=incorrect)</p>
<p>2. Second, the model generates an agreement pattern compatible with
the correctness values (e.g., CII is compatible with the agreement
patterns &#8216;abb&#8217; and &#8216;abc&#8217;, where different letters correspond to
different annotations</p>
<p>3. Finally, the model generates actual observations compatible with
the agreement patterns</p>
</div></blockquote>
<p>The model has two main sets of parameters:</p>
<blockquote>
<div><ul class="simple">
<li>theta[j] is the probability that annotator j is correct</li>
<li>omega[k] is the probability of observing an annotation of class <cite>k</cite>
over all items and annotators</li>
</ul>
</div></blockquote>
<p>At the moment the implementation of the model assumes 1) a total of 8
annotators, and 2) each item is annotated by exactly 3 annotators.</p>
<p>See the documentation for a more detailed description of the model.</p>
<p>Rzhetsky A., Shatkay, H., and Wilbur, W.J. (2009). &#8220;How to get the most from
your curation effort&#8221;, PLoS Computational Biology, 5(5).</p>
<dl class="method">
<dt id="pyanno.modelA.ModelA.are_annotations_compatible">
<tt class="descname">are_annotations_compatible</tt><big>(</big><em>annotations</em><big>)</big><a class="reference internal" href="modules/pyanno/modelA.html#ModelA.are_annotations_compatible"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelA.ModelA.are_annotations_compatible" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the annotations are compatible with the models&#8217; parameters.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="pyanno.modelA.ModelA.create_initial_state">
<em class="property">static </em><tt class="descname">create_initial_state</tt><big>(</big><em>nclasses</em>, <em>theta=None</em>, <em>omega=None</em><big>)</big><a class="reference internal" href="modules/pyanno/modelA.html#ModelA.create_initial_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelA.ModelA.create_initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory method to create a new model.</p>
<p>It is often more convenient to use this factory method over the
constructor, as one does not need to specify the initial model
parameters.</p>
<p>If not specified, the parameters theta are drawn from a uniform
distribution between 0.6 and 0.95 . The parameters omega are drawn
from a Dirichlet distribution with parameters 2.0 :</p>
<p><img class="math" src="images/math/7f234c409ac81a31d0dac1c7c28322b5cf345337.png" alt="\theta_j \sim \mathrm{Uniform}(0.6, 0.95)"/></p>
<p><img class="math" src="images/math/cf354175edf727176feecf976e43d62b387f8755.png" alt="\omega_k \sim \mathrm{Dirichlet}(2.0)"/></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nclasses</strong> (<em>int</em>) &#8211; number of possible annotation classes</li>
<li><strong>theta</strong> (<em>ndarray, shape = (n_annotators, )</em>) &#8211; theta[j] is the probability of annotator j being correct</li>
<li><strong>omega</strong> (<em>ndarray, shape = (n_classes, )</em>) &#8211; omega[k] is the probability of observing a label of class k</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.modelA.ModelA.generate_annotations">
<tt class="descname">generate_annotations</tt><big>(</big><em>nitems</em><big>)</big><a class="reference internal" href="modules/pyanno/modelA.html#ModelA.generate_annotations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelA.ModelA.generate_annotations" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate random annotations from the model.</p>
<p>The method samples random annotations from the probability
distribution defined by the model parameters:</p>
<blockquote>
<div><ol class="arabic simple">
<li>generate correct/incorrect labels for the three annotators,
according to the parameters <cite>theta</cite></li>
<li>generate agreement patterns (which annotator agrees which whom)
given the correctness information and the parameters <cite>alpha</cite></li>
<li>generate the annotations given the agreement patterns and the
parameters <cite>omega</cite></li>
</ol>
</div></blockquote>
<p>Note that, according to the model&#8217;s definition, only three annotators
per item return an annotation. Non-observed annotations have the
standard value of <tt class="xref py py-attr docutils literal"><span class="pre">MISSING_VALUE</span></tt>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nitems</strong> (<em>int</em>) &#8211; number of annotations to draw from the model</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>annotations</strong> (ndarray, shape = (n_items, n_annotators)) - annotations[i,j] is the annotation of annotator j for item i</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.modelA.ModelA.infer_labels">
<tt class="descname">infer_labels</tt><big>(</big><em>annotations</em><big>)</big><a class="reference internal" href="modules/pyanno/modelA.html#ModelA.infer_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelA.ModelA.infer_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Infer posterior distribution over label classes.</p>
<p>Compute the posterior distribution over label classes given observed
annotations, <img class="math" src="images/math/3486cefe86b6062b8244d973dd240d6e23913353.png" alt="P( \mathbf{y} | \mathbf{x}, \theta, \omega)"/>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>annotations</strong> (<em>ndarray, shape = (n_items, n_annotators)</em>) &#8211; annotations[i,j] is the annotation of annotator j for item i</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>posterior</strong> (ndarray, shape = (n_items, n_classes)) - posterior[i,k] is the posterior probability of class k given the annotation observed in item i.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.modelA.ModelA.log_likelihood">
<tt class="descname">log_likelihood</tt><big>(</big><em>annotations</em><big>)</big><a class="reference internal" href="modules/pyanno/modelA.html#ModelA.log_likelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelA.ModelA.log_likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log likelihood of a set of annotations given the model.</p>
<p>Returns log P(annotations | current model parameters).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>annotations</strong> (<em>ndarray, shape = (n_items, n_annotators)</em>) &#8211; annotations[i,j] is the annotation of annotator j for item i</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>log_lhood</strong> (float) - log likelihood of <cite>annotations</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.modelA.ModelA.map">
<tt class="descname">map</tt><big>(</big><em>annotations</em>, <em>estimate_omega=True</em><big>)</big><a class="reference internal" href="modules/pyanno/modelA.html#ModelA.map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelA.ModelA.map" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum a posteriori (MAP) estimate of parameters.</p>
<p>Estimate the parameters <tt class="xref py py-attr docutils literal"><span class="pre">theta</span></tt> and <tt class="xref py py-attr docutils literal"><span class="pre">omega</span></tt> from a set of
observed annotations using maximum a posteriori estimation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>annotations</strong> (<em>ndarray, shape = (n_items, n_annotators)</em>) &#8211; annotations[i,j] is the annotation of annotator j for item i</li>
<li><strong>estimate_omega</strong> (<em>bool</em>) &#8211; If True, the parameters <tt class="xref py py-attr docutils literal"><span class="pre">omega</span></tt> are estimated by the empirical
class frequency. If False, <tt class="xref py py-attr docutils literal"><span class="pre">omega</span></tt> is left unchanged.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.modelA.ModelA.mle">
<tt class="descname">mle</tt><big>(</big><em>annotations</em>, <em>estimate_omega=True</em><big>)</big><a class="reference internal" href="modules/pyanno/modelA.html#ModelA.mle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelA.ModelA.mle" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum likelihood estimate (MLE) of parameters.</p>
<p>Estimate the parameters <tt class="xref py py-attr docutils literal"><span class="pre">theta</span></tt> and <tt class="xref py py-attr docutils literal"><span class="pre">omega</span></tt> from a set of
observed annotations using maximum likelihood estimation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>annotations</strong> (<em>ndarray, shape = (n_items, n_annotators)</em>) &#8211; annotations[i,j] is the annotation of annotator j for item i</li>
<li><strong>estimate_omega</strong> (<em>bool</em>) &#8211; If True, the parameters <tt class="xref py py-attr docutils literal"><span class="pre">omega</span></tt> are estimated by the empirical
class frequency. If False, <tt class="xref py py-attr docutils literal"><span class="pre">omega</span></tt> is left unchanged.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.modelA.ModelA.sample_posterior_over_accuracy">
<tt class="descname">sample_posterior_over_accuracy</tt><big>(</big><em>annotations</em>, <em>nsamples</em>, <em>burn_in_samples=100</em>, <em>thin_samples=5</em>, <em>target_rejection_rate=0.3</em>, <em>rejection_rate_tolerance=0.2</em>, <em>step_optimization_nsamples=500</em>, <em>adjust_step_every=100</em><big>)</big><a class="reference internal" href="modules/pyanno/modelA.html#ModelA.sample_posterior_over_accuracy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelA.ModelA.sample_posterior_over_accuracy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return samples from posterior distribution over theta given data.</p>
<p>Samples are drawn using a variant of a Metropolis-Hasting Markov Chain
Monte Carlo (MCMC) algorithm. Sampling proceeds in two phases:</p>
<blockquote>
<div><ol class="arabic simple">
<li><em>step size estimation phase</em>: first, the step size in the
MCMC algorithm is adjusted to achieve a given rejection rate.</li>
<li><em>sampling phase</em>: second, samples are collected using the
step size from phase 1.</li>
</ol>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>annotations</strong> (<em>ndarray, shape = (n_items, n_annotators)</em>) &#8211; annotations[i,j] is the annotation of annotator j for item i</li>
<li><strong>nsamples</strong> (<em>int</em>) &#8211; number of samples to draw from the posterior</li>
<li><strong>burn_in_samples</strong> (<em>int</em>) &#8211; Discard the first <cite>burn_in_samples</cite> during the initial burn-in
phase, where the Monte Carlo chain converges to the posterior</li>
<li><strong>thin_samples</strong> (<em>int</em>) &#8211; Only return one every <cite>thin_samples</cite> samples in order to reduce
the auto-correlation in the sampling chain. This is called
&#8220;thinning&#8221; in MCMC parlance.</li>
<li><strong>target_rejection_rate</strong> (<em>float</em>) &#8211; target rejection rate for the step size estimation phase</li>
<li><strong>rejection_rate_tolerance</strong> (<em>float</em>) &#8211; the step size estimation phase is ended when the rejection rate for
all parameters is within <cite>rejection_rate_tolerance</cite> from
<cite>target_rejection_rate</cite></li>
<li><strong>step_optimization_nsamples</strong> (<em>int</em>) &#8211; number of samples to draw in the step size estimation phase</li>
<li><strong>adjust_step_every</strong> (<em>int</em>) &#8211; number of samples after which the step size is adjusted during
the step size estimation pahse</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>samples</strong> (ndarray, shape = (n_samples, n_annotators)) - samples[i,:] is one sample from the posterior distribution over the parameters <cite>theta</cite></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-pyanno.modelB">
<span id="modelb-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">modelB</span></tt> Module<a class="headerlink" href="#module-pyanno.modelB" title="Permalink to this headline">¶</a></h2>
<p>This module defines the class ModelB, a Bayesian generalization
of the model proposed in (Dawid et al., 1979).</p>
<div class="section" id="id2">
<h3>Reference<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Dawid, A. P. and A. M. Skene. 1979.  Maximum likelihood</dt>
<dd>estimation of observer error-rates using the EM algorithm.  Applied
Statistics, 28(1):20&#8211;28.</dd>
</dl>
<dl class="class">
<dt id="pyanno.modelB.ModelB">
<em class="property">class </em><tt class="descclassname">pyanno.modelB.</tt><tt class="descname">ModelB</tt><big>(</big><em>nclasses</em>, <em>nannotators</em>, <em>pi</em>, <em>theta</em>, <em>alpha=None</em>, <em>beta=None</em>, <em>**traits</em><big>)</big><a class="reference internal" href="modules/pyanno/modelB.html#ModelB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelB.ModelB" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyanno.abstract_model.AbstractModel" title="pyanno.abstract_model.AbstractModel"><tt class="xref py py-class docutils literal"><span class="pre">pyanno.abstract_model.AbstractModel</span></tt></a></p>
<p>Bayesian generalization of the model proposed in (Dawid et al., 1979).</p>
<p>Model B is a hierarchical generative model over annotations. The model
assumes the existence of &#8220;true&#8221; underlying labels for each item,
which are drawn from a categorical distribution,
<img class="math" src="images/math/f2ca003a7da0de4994b4733e203b74ff52d42553.png" alt="\pi"/>. Annotators report this labels with some noise, depending
on their accuracy, <img class="math" src="images/math/52e8ed7a3ba22130ad3984eb2cd413406475a689.png" alt="\theta"/>.</p>
<p>The model parameters are:</p>
<blockquote>
<div><ul class="simple">
<li><cite>pi[k]</cite> is the probability of label k</li>
<li><cite>theta[j,k,k&#8217;]</cite> is the probability that annotator j reports label k&#8217;
for an item whose real label is k, i.e.
P( annotator j chooses k&#8217; | real label = k)</li>
</ul>
</div></blockquote>
<p>The parameters themselves are random variables with hyperparameters</p>
<blockquote>
<div><ul class="simple">
<li><cite>beta</cite> are the parameters of a Dirichlet distribution over <cite>pi</cite></li>
<li><cite>alpha[k,:]</cite> are the parameters of Dirichlet distributions over
<cite>theta[j,k,:]</cite></li>
</ul>
</div></blockquote>
<p>See the documentation for a more detailed description of the model.</p>
<p>Dawid, A. P. and A. M. Skene. 1979.  Maximum likelihood
estimation of observer error-rates using the EM algorithm.  Applied
Statistics, 28(1):20&#8211;28.</p>
<p>Rzhetsky A., Shatkay, H., and Wilbur, W.J. (2009). &#8220;How to get the most from
your curation effort&#8221;, PLoS Computational Biology, 5(5).</p>
<dl class="staticmethod">
<dt id="pyanno.modelB.ModelB.create_initial_state">
<em class="property">static </em><tt class="descname">create_initial_state</tt><big>(</big><em>nclasses</em>, <em>nannotators</em>, <em>alpha=None</em>, <em>beta=None</em><big>)</big><a class="reference internal" href="modules/pyanno/modelB.html#ModelB.create_initial_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelB.ModelB.create_initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory method returning a model with random initial parameters.</p>
<p>It is often more convenient to use this factory method over the
constructor, as one does not need to specify the initial model
parameters.</p>
<p>The parameters theta and pi, controlling accuracy and prevalence,
are drawn at random from the prior alpha and beta:</p>
<p><div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">\theta_j^k \sim \mathrm{Dirichlet}(\mathbf{lpha_k})</tt>)</p>
latex exited with error:
[stderr]

[stdout]
This is pdfTeX, Version 3.1415926-2.3-1.40.12 (TeX Live 2011)
 restricted \write18 enabled.
entering extended mode
(./math.tex
LaTeX2e &lt;2009/09/24&gt;
Babel &lt;v3.8l&gt; and hyphenation patterns for english, dumylang, nohyphenation, ba
sque, danish, dutch, finnish, french, german, ngerman, swissgerman, hungarian, 
italian, bokmal, nynorsk, polish, portuguese, spanish, swedish, loaded.
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/base/article.cls
Document Class: article 2007/10/19 v1.4h Standard LaTeX document class
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/base/size12.clo))
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/base/inputenc.sty
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/ucs/utf8x.def))
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/ucs/ucs.sty
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/ucs/data/uni-global.def))
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amsmath/amsmath.sty
For additional information on amsmath, use the `?&#8217; option.
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amsmath/amstext.sty
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amsmath/amsgen.sty))
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amsmath/amsbsy.sty)
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amsmath/amsopn.sty))
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amscls/amsthm.sty)
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amsfonts/amssymb.sty
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amsfonts/amsfonts.sty))
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/tools/bm.sty) (./math.aux)
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/ucs/ucsencs.def)
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amsfonts/umsa.fd)
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amsfonts/umsb.fd)

! Package inputenc Error: Keyboard character used is undefined
(inputenc)                in inputencoding `utf8x&#8217;.

See the inputenc package documentation for explanation.
Type  H &lt;return&gt;  for immediate help.
 ...                                              
                                                  
l.12 ...\sim \mathrm{Dirichlet}(\mathbf{^^Glpha_k}
                                                  )$
[1] (./math.aux) )
(see the transcript file for additional information)
Output written on math.dvi (1 page, 488 bytes).
Transcript written on math.log.
</div>
</p>
<p><div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">\pi \sim \mathrm{Dirichlet}(\mathbf{eta})</tt>)</p>
latex exited with error:
[stderr]

[stdout]
This is pdfTeX, Version 3.1415926-2.3-1.40.12 (TeX Live 2011)
 restricted \write18 enabled.
entering extended mode
(./math.tex
LaTeX2e &lt;2009/09/24&gt;
Babel &lt;v3.8l&gt; and hyphenation patterns for english, dumylang, nohyphenation, ba
sque, danish, dutch, finnish, french, german, ngerman, swissgerman, hungarian, 
italian, bokmal, nynorsk, polish, portuguese, spanish, swedish, loaded.
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/base/article.cls
Document Class: article 2007/10/19 v1.4h Standard LaTeX document class
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/base/size12.clo))
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/base/inputenc.sty
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/ucs/utf8x.def))
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/ucs/ucs.sty
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/ucs/data/uni-global.def))
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amsmath/amsmath.sty
For additional information on amsmath, use the `?&#8217; option.
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amsmath/amstext.sty
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amsmath/amsgen.sty))
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amsmath/amsbsy.sty)
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amsmath/amsopn.sty))
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amscls/amsthm.sty)
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amsfonts/amssymb.sty
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amsfonts/amsfonts.sty))
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/tools/bm.sty) (./math.aux)
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/ucs/ucsencs.def)
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amsfonts/umsa.fd)
(/usr/local/texlive/2011basic/texmf-dist/tex/latex/amsfonts/umsb.fd)

! Package inputenc Error: Keyboard character used is undefined
(inputenc)                in inputencoding `utf8x&#8217;.

See the inputenc package documentation for explanation.
Type  H &lt;return&gt;  for immediate help.
 ...                                              
                                                  
l.12 $\pi \sim \mathrm{Dirichlet}(\mathbf{^^Heta}
                                                 )$
[1] (./math.aux) )
(see the transcript file for additional information)
Output written on math.dvi (1 page, 376 bytes).
Transcript written on math.log.
</div>
</p>
<p>If not defined, the prior parameters alpha ad beta are defined as
described below.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nclasses</strong> (<em>int</em>) &#8211; Number of label classes</li>
<li><strong>nannotators</strong> (<em>int</em>) &#8211; Number of annotators</li>
<li><strong>alpha</strong> (<em>ndarray</em>) &#8211; Parameters of Dirichlet prior over annotator choices
Default value is a band matrix that peaks at the correct
annotation, with a value of 16 and decays to 1 with diverging
classes. This prior is ideal for ordinal annotations.</li>
<li><strong>beta</strong> (<em>ndarray</em>) &#8211; Parameters of Dirichlet prior over model categories
Default value for beta[i] is 1.0 .</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="pyanno.modelB.ModelB.default_alpha">
<em class="property">static </em><tt class="descname">default_alpha</tt><big>(</big><em>nclasses</em><big>)</big><a class="reference internal" href="modules/pyanno/modelB.html#ModelB.default_alpha"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelB.ModelB.default_alpha" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="pyanno.modelB.ModelB.default_beta">
<em class="property">static </em><tt class="descname">default_beta</tt><big>(</big><em>nclasses</em><big>)</big><a class="reference internal" href="modules/pyanno/modelB.html#ModelB.default_beta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelB.ModelB.default_beta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyanno.modelB.ModelB.generate_annotations">
<tt class="descname">generate_annotations</tt><big>(</big><em>nitems</em><big>)</big><a class="reference internal" href="modules/pyanno/modelB.html#ModelB.generate_annotations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelB.ModelB.generate_annotations" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random annotation set from the model.</p>
<p>Sample a random set of annotations from the probability distribution
defined the current model parameters:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Label classes are generated from the prior distribution, pi</li>
<li>Annotations are generated from the conditional distribution of
annotations given classes, theta</li>
</ol>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nitems</strong> (<em>int</em>) &#8211; Number of items to sample</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>annotations</strong> (ndarray, shape = (n_items, n_annotators)) - annotations[i,j] is the annotation of annotator j for item i</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.modelB.ModelB.generate_annotations_from_labels">
<tt class="descname">generate_annotations_from_labels</tt><big>(</big><em>labels</em><big>)</big><a class="reference internal" href="modules/pyanno/modelB.html#ModelB.generate_annotations_from_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelB.ModelB.generate_annotations_from_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate random annotations from the model, given labels</p>
<p>The method samples random annotations from the conditional probability
distribution of annotations, <img class="math" src="images/math/391d16aa9be108ec679aeaf14a6f3b532f4fef19.png" alt="x_i^j"/>
given labels, <img class="math" src="images/math/6e6ceb79ebc4bf613298e0144eae25dd73de9be3.png" alt="y_i"/>:</p>
<p><img class="math" src="images/math/f5fbb69852d37c1ee3d0a6b0b4f59e9663f16470.png" alt="x_i^j \sim \mathrm{Categorical}(\mathbf{\theta_j^{y_i}})"/></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>labels</strong> (<em>ndarray, shape = (n_items,), dtype = int</em>) &#8211; Set of &#8220;true&#8221; labels</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>annotations</strong> (ndarray, shape = (n_items, n_annotators)) - annotations[i,j] is the annotation of annotator j for item i</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.modelB.ModelB.generate_labels">
<tt class="descname">generate_labels</tt><big>(</big><em>nitems</em><big>)</big><a class="reference internal" href="modules/pyanno/modelB.html#ModelB.generate_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelB.ModelB.generate_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate random labels from the model.</p>
</dd></dl>

<dl class="method">
<dt id="pyanno.modelB.ModelB.infer_labels">
<tt class="descname">infer_labels</tt><big>(</big><em>annotations</em><big>)</big><a class="reference internal" href="modules/pyanno/modelB.html#ModelB.infer_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelB.ModelB.infer_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Infer posterior distribution over label classes.</p>
<p>Compute the posterior distribution over label classes given observed
annotations, <img class="math" src="images/math/3486cefe86b6062b8244d973dd240d6e23913353.png" alt="P( \mathbf{y} | \mathbf{x}, \theta, \omega)"/>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>annotations</strong> (<em>ndarray, shape = (n_items, n_annotators)</em>) &#8211; annotations[i,j] is the annotation of annotator j for item i</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>posterior</strong> (ndarray, shape = (n_items, n_classes)) - posterior[i,k] is the posterior probability of class k given the annotation observed in item i.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.modelB.ModelB.log_likelihood">
<tt class="descname">log_likelihood</tt><big>(</big><em>annotations</em><big>)</big><a class="reference internal" href="modules/pyanno/modelB.html#ModelB.log_likelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelB.ModelB.log_likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log likelihood of a set of annotations given the model.</p>
<p>Returns log P(annotations | current model parameters).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>annotations</strong> (<em>ndarray, shape = (n_items, n_annotators)</em>) &#8211; annotations[i,j] is the annotation of annotator j for item i</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>log_lhood</strong> (float) - log likelihood of <cite>annotations</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.modelB.ModelB.map">
<tt class="descname">map</tt><big>(</big><em>annotations</em>, <em>epsilon=1e-05</em>, <em>init_accuracy=0.6</em>, <em>max_epochs=1000</em><big>)</big><a class="reference internal" href="modules/pyanno/modelB.html#ModelB.map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelB.ModelB.map" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum a posteriori (MAP) estimation of parameters.</p>
<p>Estimate the parameters <tt class="xref py py-attr docutils literal"><span class="pre">theta</span></tt> and <tt class="xref py py-attr docutils literal"><span class="pre">pi</span></tt> from a set of
observed annotations using maximum a posteriori estimation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>annotations</strong> (<em>ndarray, shape = (n_items, n_annotators)</em>) &#8211; annotations[i,j] is the annotation of annotator j for item i</li>
<li><strong>epsilon</strong> (<em>float</em>) &#8211; The estimation is interrupted when the objective function has
changed less than <cite>epsilon</cite> on average over the last 10 iterations</li>
<li><strong>initial_accuracy</strong> (<em>float</em>) &#8211; Initialize the accuracy parameters, <cite>theta</cite> to a set of
distributions where theta[j,k,k&#8217;] = initial_accuracy if k==k&#8217;,
and (1-initial_accuracy) / (n_classes - 1)</li>
<li><strong>max_epoch</strong> (<em>int</em>) &#8211; Interrupt the estimation after <cite>max_epoch</cite> iterations</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.modelB.ModelB.mle">
<tt class="descname">mle</tt><big>(</big><em>annotations</em>, <em>epsilon=1e-05</em>, <em>init_accuracy=0.6</em>, <em>max_epochs=1000</em><big>)</big><a class="reference internal" href="modules/pyanno/modelB.html#ModelB.mle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelB.ModelB.mle" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes maximum likelihood estimate (MLE) of parameters.</p>
<p>Estimate the parameters <tt class="xref py py-attr docutils literal"><span class="pre">theta</span></tt> and <tt class="xref py py-attr docutils literal"><span class="pre">pi</span></tt> from a set of
observed annotations using maximum likelihood estimation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>annotations</strong> (<em>ndarray, shape = (n_items, n_annotators)</em>) &#8211; annotations[i,j] is the annotation of annotator j for item i</li>
<li><strong>epsilon</strong> (<em>float</em>) &#8211; The estimation is interrupted when the objective function has
changed less than <cite>epsilon</cite> on average over the last 10 iterations</li>
<li><strong>initial_accuracy</strong> (<em>float</em>) &#8211; Initialize the accuracy parameters, <cite>theta</cite> to a set of
distributions where theta[j,k,k&#8217;] = initial_accuracy if k==k&#8217;,
and (1-initial_accuracy) / (n_classes - 1)</li>
<li><strong>max_epoch</strong> (<em>int</em>) &#8211; Interrupt the estimation after <cite>max_epoch</cite> iterations</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.modelB.ModelB.sample_posterior_over_accuracy">
<tt class="descname">sample_posterior_over_accuracy</tt><big>(</big><em>annotations</em>, <em>nsamples</em>, <em>burn_in_samples=0</em>, <em>thin_samples=1</em><big>)</big><a class="reference internal" href="modules/pyanno/modelB.html#ModelB.sample_posterior_over_accuracy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelB.ModelB.sample_posterior_over_accuracy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return samples from posterior distribution over theta given data.</p>
<p>Samples are drawn using Gibbs sampling, i.e., alternating between
sampling from the conditional distribution of theta given the
annotations and the label classes, and sampling from the conditional
distribution of the classes given theta and the annotations.</p>
<p>This results in a fast-mixing sampler, and so the parameters
controlling burn-in and thinning can be set to a small number
of samples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>annotations</strong> (<em>ndarray, shape = (n_items, n_annotators)</em>) &#8211; annotations[i,j] is the annotation of annotator j for item i</li>
<li><strong>nsamples</strong> (<em>int</em>) &#8211; number of samples to draw from the posterior</li>
<li><strong>burn_in_samples</strong> (<em>int</em>) &#8211; Discard the first <cite>burn_in_samples</cite> during the initial burn-in
phase, where the Monte Carlo chain converges to the posterior</li>
<li><strong>thin_samples</strong> (<em>int</em>) &#8211; Only return one every <cite>thin_samples</cite> samples in order to reduce
the auto-correlation in the sampling chain. This is called
&#8220;thinning&#8221; in MCMC parlance.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>samples</strong> (ndarray, shape = (n_samples, n_annotators, nclasses, nclasses)) - samples[i,...] is one sample from the posterior distribution over the parameters <cite>theta</cite></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-pyanno.modelBt">
<span id="modelbt-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">modelBt</span></tt> Module<a class="headerlink" href="#module-pyanno.modelBt" title="Permalink to this headline">¶</a></h2>
<p>Definition of model B-with-theta.</p>
<dl class="class">
<dt id="pyanno.modelBt.ModelBt">
<em class="property">class </em><tt class="descclassname">pyanno.modelBt.</tt><tt class="descname">ModelBt</tt><big>(</big><em>nclasses</em>, <em>nannotators</em>, <em>gamma</em>, <em>theta</em>, <em>**traits</em><big>)</big><a class="reference internal" href="modules/pyanno/modelBt.html#ModelBt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelBt.ModelBt" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyanno.abstract_model.AbstractModel" title="pyanno.abstract_model.AbstractModel"><tt class="xref py py-class docutils literal"><span class="pre">pyanno.abstract_model.AbstractModel</span></tt></a></p>
<p>Implementation of Model B-with-theta from (Rzhetsky et al., 2009).</p>
<p>The model assumes the existence of &#8220;true&#8221; underlying labels for each item,
which are drawn from a categorical distribution, gamma. Annotators report
this labels with some noise. Crucially, the noise distribution is
described by a small number of parameters (one per annotator),
which their estimation efficient and less sensitive to local optima.</p>
<p>The model parameters are:</p>
<ul class="simple">
<li>gamma[k] is the probability of label k</li>
<li>theta[j] parametrized the probability that annotator j reports label k&#8217;.
More specifically, P( annotator j chooses k&#8217; | real label = k) is
theta[j] for k&#8217; = k, or (1 - theta[j]) / sum(theta) if k&#8217; != k .</li>
</ul>
<p>See the documentation for a more detailed description of the model.</p>
<p>For a version of this model optimized for the loop design described
in (Rzhetsky et al., 2009), see <tt class="xref py py-class docutils literal"><span class="pre">ModelBtLoopDesign</span></tt>.</p>
<p>Rzhetsky A., Shatkay, H., and Wilbur, W.J. (2009). &#8220;How to get the most from
your curation effort&#8221;, PLoS Computational Biology, 5(5).</p>
<dl class="staticmethod">
<dt id="pyanno.modelBt.ModelBt.create_initial_state">
<em class="property">static </em><tt class="descname">create_initial_state</tt><big>(</big><em>nclasses</em>, <em>nannotators</em>, <em>gamma=None</em>, <em>theta=None</em><big>)</big><a class="reference internal" href="modules/pyanno/modelBt.html#ModelBt.create_initial_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelBt.ModelBt.create_initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory method returning a model with random initial parameters.</p>
<p>&lt;behaviour&gt;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nclasses</strong> (<em>int</em>) &#8211; Number of label classes</li>
<li><strong>nannotators</strong> (<em>int</em>) &#8211; Number of annotators</li>
<li><strong>gamma</strong> (<em>nparray</em>) &#8211; An array of floats with size that holds the probability of each
annotation value. Default is None</li>
<li><strong>theta</strong> (<em>nparray</em>) &#8211; An array of floats that the parameters of P( v_i | psi ) (one for
each annotator)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>model</strong> (<a class="reference internal" href="#pyanno.modelBt.ModelBt" title="pyanno.modelBt.ModelBt"><tt class="xref py py-class docutils literal"><span class="pre">ModelBt</span></tt></a>) - Instance of ModelBt</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.modelBt.ModelBt.generate_annotations">
<tt class="descname">generate_annotations</tt><big>(</big><em>nitems</em><big>)</big><a class="reference internal" href="modules/pyanno/modelBt.html#ModelBt.generate_annotations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelBt.ModelBt.generate_annotations" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random annotation set from the model.</p>
<p>Sample a random set of annotations from the probability distribution
defined the current model parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nitems</strong> (<em>int</em>) &#8211; Number of items to sample</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>annotations</strong> (ndarray, shape = (n_items, n_annotators)) - annotations[i,j] is the annotation of annotator j for item i</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.modelBt.ModelBt.generate_annotations_from_labels">
<tt class="descname">generate_annotations_from_labels</tt><big>(</big><em>labels</em><big>)</big><a class="reference internal" href="modules/pyanno/modelBt.html#ModelBt.generate_annotations_from_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelBt.ModelBt.generate_annotations_from_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate random annotations given labels.</p>
</dd></dl>

<dl class="method">
<dt id="pyanno.modelBt.ModelBt.generate_labels">
<tt class="descname">generate_labels</tt><big>(</big><em>nitems</em><big>)</big><a class="reference internal" href="modules/pyanno/modelBt.html#ModelBt.generate_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelBt.ModelBt.generate_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate random labels from the model.</p>
</dd></dl>

<dl class="method">
<dt id="pyanno.modelBt.ModelBt.infer_labels">
<tt class="descname">infer_labels</tt><big>(</big><em>annotations</em><big>)</big><a class="reference internal" href="modules/pyanno/modelBt.html#ModelBt.infer_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelBt.ModelBt.infer_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Infer posterior distribution over true labels.</p>
<p>Returns P( label | annotations, parameters), where parameters is the
current point estimate of the parameters pi and theta.</p>
</dd></dl>

<dl class="method">
<dt id="pyanno.modelBt.ModelBt.log_likelihood">
<tt class="descname">log_likelihood</tt><big>(</big><em>annotations</em><big>)</big><a class="reference internal" href="modules/pyanno/modelBt.html#ModelBt.log_likelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelBt.ModelBt.log_likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log likelihood of annotations given the model.</p>
</dd></dl>

<dl class="method">
<dt id="pyanno.modelBt.ModelBt.map">
<tt class="descname">map</tt><big>(</big><em>annotations</em>, <em>estimate_gamma=True</em><big>)</big><a class="reference internal" href="modules/pyanno/modelBt.html#ModelBt.map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelBt.ModelBt.map" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyanno.modelBt.ModelBt.mle">
<tt class="descname">mle</tt><big>(</big><em>annotations</em>, <em>estimate_gamma=True</em><big>)</big><a class="reference internal" href="modules/pyanno/modelBt.html#ModelBt.mle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelBt.ModelBt.mle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyanno.modelBt.ModelBt.sample_posterior_over_accuracy">
<tt class="descname">sample_posterior_over_accuracy</tt><big>(</big><em>annotations</em>, <em>nsamples</em>, <em>burn_in_samples=100</em>, <em>thin_samples=5</em>, <em>target_rejection_rate=0.3</em>, <em>rejection_rate_tolerance=0.2</em>, <em>step_optimization_nsamples=500</em>, <em>adjust_step_every=100</em><big>)</big><a class="reference internal" href="modules/pyanno/modelBt.html#ModelBt.sample_posterior_over_accuracy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.modelBt.ModelBt.sample_posterior_over_accuracy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return samples from posterior distribution over theta given data.</p>
<p>Draw samples from P(theta | data, model parameters).
The accuracy parameters, theta, control the probability of an annotator
reporting the correct label (see <a class="reference internal" href="#pyanno.modelBt.ModelBt" title="pyanno.modelBt.ModelBt"><tt class="xref py py-class docutils literal"><span class="pre">ModelBt</span></tt></a>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>annotations</strong> (<em>ndarray, shape = (n_items, n_annotators)</em>) &#8211; annotations[i,j] is the annotation of annotator j for item i</li>
<li><strong>nsamples</strong> (<em>int</em>) &#8211; Number of samples to return (i.e., burn-in and thinning samples
are not included)</li>
<li><strong>burn_in_samples</strong> (<em>int</em>) &#8211; Discard the first <cite>burn_in_samples</cite> during the initial burn-in
phase, where the Monte Carlo chain converges to the posterior</li>
<li><strong>thin_samples</strong> (<em>int</em>) &#8211; Only return one every <cite>thin_samples</cite> samples in order to reduce
the auto-correlation in the sampling chain. This is called
&#8220;thinning&#8221; in MCMC parlance.</li>
<li><strong>target_rejection_rate</strong> (<em>float</em>) &#8211; target rejection rate for the step size estimation phase</li>
<li><strong>rejection_rate_tolerance</strong> (<em>float</em>) &#8211; the step size estimation phase is ended when the rejection rate for
all parameters is within <cite>rejection_rate_tolerance</cite> from
<cite>target_rejection_rate</cite></li>
<li><strong>step_optimization_nsamples</strong> (<em>int</em>) &#8211; number of samples to draw in the step size estimation phase</li>
<li><strong>adjust_step_every</strong> (<em>int</em>) &#8211; number of samples after which the step size is adjusted during
the step size estimation pahse</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>samples</strong> (ndarray, shape = (n_samples, n_annotators)) - samples[i,:] is one sample from the posterior distribution over the parameters <cite>theta</cite></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyanno.annotations">
<span id="annotations-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">annotations</span></tt> Module<a class="headerlink" href="#module-pyanno.annotations" title="Permalink to this headline">¶</a></h2>
<p>Defines objects to create and manipulate raw annotations.</p>
<dl class="class">
<dt id="pyanno.annotations.AnnotationsContainer">
<em class="property">class </em><tt class="descclassname">pyanno.annotations.</tt><tt class="descname">AnnotationsContainer</tt><a class="reference internal" href="modules/pyanno/annotations.html#AnnotationsContainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.annotations.AnnotationsContainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">traits.has_traits.HasStrictTraits</span></tt></p>
<dl class="attribute">
<dt id="pyanno.annotations.AnnotationsContainer.DEFAULT_MISSING_VALUES_ALL">
<tt class="descname">DEFAULT_MISSING_VALUES_ALL</tt><em class="property"> = ['-1', 'NA', 'None', '*', -1, nan, None]</em><a class="headerlink" href="#pyanno.annotations.AnnotationsContainer.DEFAULT_MISSING_VALUES_ALL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyanno.annotations.AnnotationsContainer.DEFAULT_MISSING_VALUES_NUM">
<tt class="descname">DEFAULT_MISSING_VALUES_NUM</tt><em class="property"> = [-1, nan, None]</em><a class="headerlink" href="#pyanno.annotations.AnnotationsContainer.DEFAULT_MISSING_VALUES_NUM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyanno.annotations.AnnotationsContainer.DEFAULT_MISSING_VALUES_STR">
<tt class="descname">DEFAULT_MISSING_VALUES_STR</tt><em class="property"> = ['-1', 'NA', 'None', '*']</em><a class="headerlink" href="#pyanno.annotations.AnnotationsContainer.DEFAULT_MISSING_VALUES_STR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="pyanno.annotations.AnnotationsContainer.from_array">
<em class="property">static </em><tt class="descname">from_array</tt><big>(</big><em>x</em>, <em>missing_values=None</em>, <em>name=''</em><big>)</big><a class="reference internal" href="modules/pyanno/annotations.html#AnnotationsContainer.from_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.annotations.AnnotationsContainer.from_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an annotations object from an array or list-of-lists.</p>
<p>Input:
x &#8211; array or list-of-lists containing numerical or string annotations
missing_values &#8211; list of values that are considered missing values.</p>
<blockquote>
<div>Default is [&#8216;-1&#8217;, &#8216;NA&#8217;, &#8216;None&#8217;, &#8216;*&#8217;, -1, np.nan, None]</div></blockquote>
<p>name &#8211; name of the annotations (for user interaction)</p>
</dd></dl>

<dl class="staticmethod">
<dt id="pyanno.annotations.AnnotationsContainer.from_file">
<em class="property">static </em><tt class="descname">from_file</tt><big>(</big><em>filename</em>, <em>missing_values=None</em><big>)</big><a class="reference internal" href="modules/pyanno/annotations.html#AnnotationsContainer.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.annotations.AnnotationsContainer.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Load annotations from a file.</p>
<p>The file is a text file with a columns separated by spaces and/or
commas, and rows on different lines.</p>
<p>Input:
filename &#8211; file name
missing_values &#8211; list of labels that are considered missing values.</p>
<blockquote>
<div>Default is [&#8216;-1&#8217;, &#8216;NA&#8217;, &#8216;None&#8217;, &#8216;*&#8217;]</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="pyanno.annotations.AnnotationsContainer.save_to">
<tt class="descname">save_to</tt><big>(</big><em>filename</em>, <em>set_name=False</em><big>)</big><a class="reference internal" href="modules/pyanno/annotations.html#AnnotationsContainer.save_to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.annotations.AnnotationsContainer.save_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Save raw annotations to file.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyanno.annotations.load_annotations">
<tt class="descclassname">pyanno.annotations.</tt><tt class="descname">load_annotations</tt><big>(</big><em>filename</em>, <em>missing_values=None</em><big>)</big><a class="reference internal" href="modules/pyanno/annotations.html#load_annotations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.annotations.load_annotations" title="Permalink to this definition">¶</a></dt>
<dd><p>Load annotations from file.</p>
<p>The file is a text file with a columns separated by spaces and/or
commas, and rows on different lines.</p>
<p>Input:
filename &#8211; file name
missing_values &#8211; list of labels that are considered missing values.</p>
<blockquote>
<div>Default is [&#8216;-1&#8217;, &#8216;NA&#8217;, &#8216;None&#8217;, &#8216;*&#8217;]</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-pyanno.sampling">
<span id="sampling-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">sampling</span></tt> Module<a class="headerlink" href="#module-pyanno.sampling" title="Permalink to this headline">¶</a></h2>
<p>This module defines functions to sample from a distribution given its
log likelihood.</p>
<dl class="function">
<dt id="pyanno.sampling.optimize_step_size">
<tt class="descclassname">pyanno.sampling.</tt><tt class="descname">optimize_step_size</tt><big>(</big><em>likelihood</em>, <em>x0</em>, <em>arguments</em>, <em>x_lower</em>, <em>x_upper</em>, <em>n_samples</em>, <em>recomputing_cycle</em>, <em>target_rejection_rate</em>, <em>tolerance</em><big>)</big><a class="reference internal" href="modules/pyanno/sampling.html#optimize_step_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.sampling.optimize_step_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute optimum jump for MCMC estimation of credible intervals.</p>
<p>Adjust jump size in Metropolis-Hasting MC to achieve target rejection rate.
Jump size is estimated for each parameter separately.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>likelihood</strong> (<em>function(params, arguments)</em>) &#8211; Function returning the <em>unnormalized</em> log likelihood of data given
the parameters. The function accepts two arguments:
<cite>params</cite> is the vector of parameters; <cite>arguments</cite> contains any
additional argument that is needed to compute the log likelihood.</li>
<li><strong>x0</strong> (<em>ndarray, shape = (n_parameters, )</em>) &#8211; Initial parameters value.</li>
<li><strong>arguments</strong> (<em>any</em>) &#8211; Additional argument passed to the function <cite>likelihood</cite>.</li>
<li><strong>x_lower</strong> (<em>ndarray, shape = (n_parameters, )</em>) &#8211; Lower bound for the parameters.</li>
<li><strong>x_upper</strong> (<em>ndarray, shape = (n_parameters, )</em>) &#8211; Upper bound for the parameters.</li>
<li><strong>n_samples</strong> (<em>int</em>) &#8211; Total number of samples to draw during the optimization.</li>
<li><strong>recomputing_cycle</strong> (<em>int</em>) &#8211; Number of samples over which the rejection rates are computed. After
<cite>recomputing_cycle</cite> samples, the step size is adapted and the
rejection rates are reset to 0.</li>
<li><strong>target_rejection_rate</strong> (<em>float</em>) &#8211; Target rejection rate. If the rejection rate over the latest cycle is
closer than <cite>tolerance</cite> to this target, the optimization phase is
concluded.</li>
<li><strong>tolerance</strong> (<em>float</em>) &#8211; Tolerated deviation from <cite>target_rejection_rate</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>step</strong> (ndarray, shape = (n_parameters, )) - The final optimized step size.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyanno.sampling.sample_distribution">
<tt class="descclassname">pyanno.sampling.</tt><tt class="descname">sample_distribution</tt><big>(</big><em>likelihood</em>, <em>x0</em>, <em>arguments</em>, <em>step</em>, <em>nsamples</em>, <em>x_lower</em>, <em>x_upper</em><big>)</big><a class="reference internal" href="modules/pyanno/sampling.html#sample_distribution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.sampling.sample_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>General-purpose sampling routine for MCMC sampling.</p>
<p>Draw samples from a distribution given its unnormalized log likelihood
using the Metropolis-Hasting Monte Carlo algorithm.</p>
<p>It is recommended to optimize the step size, <cite>step</cite>, using the function
<a class="reference internal" href="#pyanno.sampling.optimize_step_size" title="pyanno.sampling.optimize_step_size"><tt class="xref py py-func docutils literal"><span class="pre">optimize_step_size()</span></tt></a> in order to reduce the autocorrelation between</p>
<blockquote>
<div>successive samples.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>likelihood</strong> (<em>function(params, arguments)</em>) &#8211; Function returning the <em>unnormalized</em> log likelihood of data given
the parameters. The function accepts two arguments:
<cite>params</cite> is the vector of parameters; <cite>arguments</cite> contains any
additional argument that is needed to compute the log likelihood.</li>
<li><strong>x0</strong> (<em>ndarray, shape = (n_parameters, )</em>) &#8211; Initial parameters value.</li>
<li><strong>arguments</strong> (<em>any</em>) &#8211; Additional argument passed to the function <cite>likelihood</cite>.</li>
<li><strong>step</strong> (<em>ndarray, shape = (n_parameters, )</em>) &#8211; Width of the proposal distribution over the parameters.</li>
<li><strong>nsamples</strong> (<em>int</em>) &#8211; Number of samples to draw from the distribution.</li>
<li><strong>x_lower</strong> (<em>ndarray, shape = (n_parameters, )</em>) &#8211; Lower bound for the parameters.</li>
<li><strong>x_upper</strong> (<em>ndarray, shape = (n_parameters, )</em>) &#8211; Upper bound for the parameters.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyanno.sampling.sample_from_proposal_distribution">
<tt class="descclassname">pyanno.sampling.</tt><tt class="descname">sample_from_proposal_distribution</tt><big>(</big><em>theta</em>, <em>step</em>, <em>lower</em>, <em>upper</em><big>)</big><a class="reference internal" href="modules/pyanno/sampling.html#sample_from_proposal_distribution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.sampling.sample_from_proposal_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns one sample from the proposal distribution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>theta</strong> (<em>float</em>) &#8211; current parameter value</li>
<li><strong>step</strong> (<em>float</em>) &#8211; width of the proposal distribution over <cite>theta</cite></li>
<li><strong>lower</strong> (<em>float</em>) &#8211; lower bound for <cite>theta</cite></li>
<li><strong>upper</strong> (<em>float</em>) &#8211; upper bound for <cite>theta</cite></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>theta_new</strong> (float) - new sample from the distribution over theta</li>
<li><strong>log_q_ratio</strong> (float) - log-ratio of probability of new value given old value to probability of old value given new value</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pyanno.database">
<span id="database-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">database</span></tt> Module<a class="headerlink" href="#module-pyanno.database" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyanno.database.PyannoDatabase">
<em class="property">class </em><tt class="descclassname">pyanno.database.</tt><tt class="descname">PyannoDatabase</tt><big>(</big><em>filename</em><big>)</big><a class="reference internal" href="modules/pyanno/database.html#PyannoDatabase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.database.PyannoDatabase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<dl class="method">
<dt id="pyanno.database.PyannoDatabase.close">
<tt class="descname">close</tt><big>(</big><big>)</big><a class="reference internal" href="modules/pyanno/database.html#PyannoDatabase.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.database.PyannoDatabase.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close database.</p>
</dd></dl>

<dl class="method">
<dt id="pyanno.database.PyannoDatabase.remove">
<tt class="descname">remove</tt><big>(</big><em>data_id</em>, <em>idx</em><big>)</big><a class="reference internal" href="modules/pyanno/database.html#PyannoDatabase.remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.database.PyannoDatabase.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove entry from database.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data_id</strong> (<em>string</em>) &#8211; Readable <strong>unique</strong> identifier for the annotations set</li>
<li><strong>idx</strong> (<em>int</em>) &#8211; Index in the list of entries with id <cite>data_id</cite></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyanno.database.PyannoDatabase.retrieve_id">
<tt class="descname">retrieve_id</tt><big>(</big><em>data_id</em><big>)</big><a class="reference internal" href="modules/pyanno/database.html#PyannoDatabase.retrieve_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.database.PyannoDatabase.retrieve_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyanno.database.PyannoDatabase.store_result">
<tt class="descname">store_result</tt><big>(</big><em>data_id</em>, <em>anno_container</em>, <em>model</em>, <em>value</em><big>)</big><a class="reference internal" href="modules/pyanno/database.html#PyannoDatabase.store_result"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.database.PyannoDatabase.store_result" title="Permalink to this definition">¶</a></dt>
<dd><p>Store a pyAnno result in the database.</p>
<p>The <cite>data_id</cite> must be a <strong>unique</strong> identifier for an annotations
set.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data_id</strong> (<em>string</em>) &#8211; Readable <strong>unique</strong> identifier for the annotations set (e.g.,
the file name where the annotations are stored).</li>
<li><strong>anno_container</strong> (<em>AnnotationsContainer</em>) &#8211; An annotations container (see :class:<a href="#id3"><span class="problematic" id="id4">`</span></a>~AnnotationsContainer).</li>
<li><strong>model</strong> (<em>object</em>) &#8211; pyAnno model object instance</li>
<li><strong>value</strong> (<em>float</em>) &#8211; value of the objective function for the model-annotations pair,
typically the log likelihood of the annotations given the model</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyanno.database.PyannoResult">
<em class="property">class </em><tt class="descclassname">pyanno.database.</tt><tt class="descname">PyannoResult</tt><a class="reference internal" href="modules/pyanno/database.html#PyannoResult"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.database.PyannoResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">traits.has_traits.HasStrictTraits</span></tt></p>
</dd></dl>

</div>
<div class="section" id="module-pyanno.util">
<span id="util-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">util</span></tt> Module<a class="headerlink" href="#module-pyanno.util" title="Permalink to this headline">¶</a></h2>
<dl class="exception">
<dt id="pyanno.util.PyannoValueError">
<em class="property">exception </em><tt class="descclassname">pyanno.util.</tt><tt class="descname">PyannoValueError</tt><a class="reference internal" href="modules/pyanno/util.html#PyannoValueError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.util.PyannoValueError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">exceptions.ValueError</span></tt></p>
<p>ValueError subclass raised by pyanno functions and methods.</p>
</dd></dl>

<dl class="class">
<dt id="pyanno.util.benchmark">
<em class="property">class </em><tt class="descclassname">pyanno.util.</tt><tt class="descname">benchmark</tt><big>(</big><em>name</em><big>)</big><a class="reference internal" href="modules/pyanno/util.html#benchmark"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.util.benchmark" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
</dd></dl>

<dl class="function">
<dt id="pyanno.util.check_unchanged">
<tt class="descclassname">pyanno.util.</tt><tt class="descname">check_unchanged</tt><big>(</big><em>func_new</em>, <em>func_old</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="modules/pyanno/util.html#check_unchanged"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.util.check_unchanged" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyanno.util.compute_counts">
<tt class="descclassname">pyanno.util.</tt><tt class="descname">compute_counts</tt><big>(</big><em>annotations</em>, <em>nclasses</em><big>)</big><a class="reference internal" href="modules/pyanno/util.html#compute_counts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.util.compute_counts" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform annotation data in counts format.</p>
<p>At the moment, it is hard coded for 8 annotators, 3 annotators active at
any time.</p>
<p>Input:
annotations &#8211; Input data (integer array, nitems x 8)
nclasses &#8211; number of annotation values (# classes)</p>
<p>Ouput:
data &#8211; data[i,j] is the number of times the combination of annotators</p>
<blockquote>
<div>number <cite>j</cite> voted according to pattern <cite>i</cite>
(integer array, nclasses^3 x 8)</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="pyanno.util.create_band_matrix">
<tt class="descclassname">pyanno.util.</tt><tt class="descname">create_band_matrix</tt><big>(</big><em>shape</em>, <em>diagonal_elements</em><big>)</big><a class="reference internal" href="modules/pyanno/util.html#create_band_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.util.create_band_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyanno.util.dirichlet_llhood">
<tt class="descclassname">pyanno.util.</tt><tt class="descname">dirichlet_llhood</tt><big>(</big><em>theta</em>, <em>alpha</em><big>)</big><a class="reference internal" href="modules/pyanno/util.html#dirichlet_llhood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.util.dirichlet_llhood" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log likelihood of theta under Dirichlet(alpha).</p>
</dd></dl>

<dl class="function">
<dt id="pyanno.util.is_valid">
<tt class="descclassname">pyanno.util.</tt><tt class="descname">is_valid</tt><big>(</big><em>annotations</em><big>)</big><a class="reference internal" href="modules/pyanno/util.html#is_valid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.util.is_valid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if annotation is valid.</p>
<p>An annotation is valid if it is not equal to the missing value,
MISSING_VALUE.</p>
</dd></dl>

<dl class="function">
<dt id="pyanno.util.labels_count">
<tt class="descclassname">pyanno.util.</tt><tt class="descname">labels_count</tt><big>(</big><em>annotations</em>, <em>nclasses</em>, <em>missing_val=-1</em><big>)</big><a class="reference internal" href="modules/pyanno/util.html#labels_count"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.util.labels_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the total count of labels in observed annotations.</p>
</dd></dl>

<dl class="function">
<dt id="pyanno.util.labels_frequency">
<tt class="descclassname">pyanno.util.</tt><tt class="descname">labels_frequency</tt><big>(</big><em>annotations</em>, <em>nclasses</em>, <em>missing_val=-1</em><big>)</big><a class="reference internal" href="modules/pyanno/util.html#labels_frequency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.util.labels_frequency" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the total frequency of labels in observed annotations.</p>
</dd></dl>

<dl class="function">
<dt id="pyanno.util.majority_vote">
<tt class="descclassname">pyanno.util.</tt><tt class="descname">majority_vote</tt><big>(</big><em>annotations</em><big>)</big><a class="reference internal" href="modules/pyanno/util.html#majority_vote"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.util.majority_vote" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute an estimate of the real class by majority vote.</p>
<p>In case of ties, return the class with smallest number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>annotations</strong> (<em>ndarray, shape = (n_items, n_annotators)</em>) &#8211; annotations[i,j] is the annotation made by annotator j on item i</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>vote <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, shape = (n_items, )</span></dt>
<dd>vote[i] is the majority vote estimate for item i</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyanno.util.ninf_to_num">
<tt class="descclassname">pyanno.util.</tt><tt class="descname">ninf_to_num</tt><big>(</big><em>x</em><big>)</big><a class="reference internal" href="modules/pyanno/util.html#ninf_to_num"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.util.ninf_to_num" title="Permalink to this definition">¶</a></dt>
<dd><p>Substitute -inf with smallest floating point number.</p>
</dd></dl>

<dl class="function">
<dt id="pyanno.util.normalize">
<tt class="descclassname">pyanno.util.</tt><tt class="descname">normalize</tt><big>(</big><em>x</em>, <em>dtype=&lt;type 'float'&gt;</em><big>)</big><a class="reference internal" href="modules/pyanno/util.html#normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.util.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a normalized distribution (sums to 1.0).</p>
</dd></dl>

<dl class="function">
<dt id="pyanno.util.random_categorical">
<tt class="descclassname">pyanno.util.</tt><tt class="descname">random_categorical</tt><big>(</big><em>distr</em>, <em>nsamples</em><big>)</big><a class="reference internal" href="modules/pyanno/util.html#random_categorical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.util.random_categorical" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an array of samples from a categorical distribution.</p>
</dd></dl>

<dl class="function">
<dt id="pyanno.util.string_wrap">
<tt class="descclassname">pyanno.util.</tt><tt class="descname">string_wrap</tt><big>(</big><em>st</em>, <em>mode</em><big>)</big><a class="reference internal" href="modules/pyanno/util.html#string_wrap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyanno.util.string_wrap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="pyanno.measures.html">measures Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyanno.measures.html#id1"><tt class="docutils literal"><span class="pre">measures</span></tt> Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyanno.measures.html#module-pyanno.measures.agreement"><tt class="docutils literal"><span class="pre">agreement</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyanno.measures.html#module-pyanno.measures.covariation"><tt class="docutils literal"><span class="pre">covariation</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyanno.measures.html#module-pyanno.measures.distances"><tt class="docutils literal"><span class="pre">distances</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyanno.measures.html#module-pyanno.measures.helpers"><tt class="docutils literal"><span class="pre">helpers</span></tt> Module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pyanno.plots.html">plots Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyanno.plots.html#id1"><tt class="docutils literal"><span class="pre">plots</span></tt> Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyanno.plots.html#module-pyanno.plots.hinton_plot"><tt class="docutils literal"><span class="pre">hinton_plot</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyanno.plots.html#module-pyanno.plots.matrix_plot"><tt class="docutils literal"><span class="pre">matrix_plot</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyanno.plots.html#module-pyanno.plots.plot_tools"><tt class="docutils literal"><span class="pre">plot_tools</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyanno.plots.html#module-pyanno.plots.pyanno_plots"><tt class="docutils literal"><span class="pre">pyanno_plots</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyanno.plots.html#module-pyanno.plots.theta_plot"><tt class="docutils literal"><span class="pre">theta_plot</span></tt> Module</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">pyanno Package</a><ul>
<li><a class="reference internal" href="#id1"><tt class="docutils literal"><span class="pre">pyanno</span></tt> Package</a></li>
<li><a class="reference internal" href="#abstract-model-module"><tt class="docutils literal"><span class="pre">abstract_model</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-pyanno.modelA"><tt class="docutils literal"><span class="pre">modelA</span></tt> Module</a><ul>
<li><a class="reference internal" href="#reference">Reference</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-pyanno.modelB"><tt class="docutils literal"><span class="pre">modelB</span></tt> Module</a><ul>
<li><a class="reference internal" href="#id2">Reference</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-pyanno.modelBt"><tt class="docutils literal"><span class="pre">modelBt</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-pyanno.annotations"><tt class="docutils literal"><span class="pre">annotations</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-pyanno.sampling"><tt class="docutils literal"><span class="pre">sampling</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-pyanno.database"><tt class="docutils literal"><span class="pre">database</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-pyanno.util"><tt class="docutils literal"><span class="pre">util</span></tt> Module</a></li>
<li><a class="reference internal" href="#subpackages">Subpackages</a><ul>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="modules.html"
                        title="previous chapter">Project Modules</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="pyanno.measures.html"
                        title="next chapter">measures Package</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="sources/pyanno.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pyanno.measures.html" title="measures Package"
             >next</a> |</li>
        <li class="right" >
          <a href="modules.html" title="Project Modules"
             >previous</a> |</li>
        <li><a href="index.html">pyanno 2.0dev documentation</a> &raquo;</li>
          <li><a href="modules.html" >Project Modules</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Pietro Berkes, Bob Carpenter, Andrey Rzhetsky, James A. Evans.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>